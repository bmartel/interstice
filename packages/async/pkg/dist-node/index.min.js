"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var litHtml=require("lit-html"),litElement=require("lit-element");const PENDING_EVENT="pending",pending=e=>new CustomEvent("pending",{composed:!0,bubbles:!0,detail:{promise:e}}),resolved=new WeakSet,lazy=litHtml.directive((e,t)=>r=>{resolved.has(r)||(e.then(()=>resolved.add(r)),r.startNode.parentNode.dispatchEvent(pending(e))),r.setValue(t)}),AsyncBoundary=e=>(class extends e{static get properties(){return{_error:Boolean,_pending:Boolean,_pendingCount:Number}}constructor(){super(),this._pending=!1,this._pendingCount=0,this.addEventListener("pending",async e=>{this._pending=!0,this._pendingCount++;try{await e.detail.promise}catch(t){this._error=!0,this.error(t,e)}this._pendingCount--,this._pending=0!==this._pendingCount})}});class AsyncElement extends litElement.LitElement{constructor(){super(),this.deps=[]}firstUpdated(){this.setup()}update(e){return this.deps.some(t=>e.has(t))&&this.reload(),super.update(e)}setup(){this._loadedPromise||this.reload()}loader(){this._loaded=null,this._errored=null,this._loadedPromise=new Promise((e,t)=>{this._resolveLoaded=e,this._rejectLoaded=t}),pending(this._loadedPromise),this._loadedPromise.then(e=>(this._loaded=(()=>e),this.requestUpdate(),e)).catch(e=>{this._errored=e,this.requestUpdate()})}reload(){this.loader(),this.resolve()}loaded(){return this._loaded}errored(){return this._errored?this.erroring(this._errored):null}async resolve(){try{const e=await this.asyncRender();return this._resolveLoaded(e),e}catch(e){return this._rejectLoaded(e),null}}erroring(e){return litElement.html``}loading(){return litElement.html``}asyncRender(){return Promise.reject("Must implement asyncRender() in child components")}render(){const e=this.loaded();if(e)return e();const t=this.errored();return t||this.loading()}}exports.AsyncBoundary=AsyncBoundary,exports.AsyncElement=AsyncElement,exports.PENDING_EVENT="pending",exports.lazy=lazy,exports.pending=pending;
//# sourceMappingURL=index.min.js.map