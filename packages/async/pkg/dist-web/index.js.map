{"version":3,"file":"index.js","sources":["../dist-src/async.js"],"sourcesContent":["import { LitElement, html } from 'lit-element';\nexport class AsyncElement extends LitElement {\n  constructor() {\n    super();\n    this.deps = [];\n  }\n\n  firstUpdated() {\n    this.setup();\n  }\n\n  update(changedProps) {\n    if (this.deps.some(k => changedProps.has(k))) {\n      this.reload();\n    }\n\n    return super.update(changedProps);\n  }\n\n  setup() {\n    if (!this._loadedPromise) {\n      this.reload();\n    }\n  }\n\n  loader() {\n    this._loaded = null;\n    this._errored = null;\n    this._loadedPromise = new Promise((resolve, reject) => {\n      this._resolveLoaded = resolve;\n      this._rejectLoaded = reject;\n    });\n\n    this._loadedPromise.then(data => {\n      this._loaded = () => data;\n\n      this.requestUpdate();\n      return data;\n    }).catch(err => {\n      this._errored = err;\n      this.requestUpdate();\n    });\n  }\n\n  reload() {\n    this.loader();\n    this.resolve();\n  }\n\n  loaded() {\n    return this._loaded;\n  }\n\n  errored() {\n    if (this._errored) {\n      return this.erroring(this._errored);\n    }\n\n    return null;\n  }\n\n  async resolve() {\n    try {\n      const data = await this.asyncRender();\n\n      this._resolveLoaded(data);\n\n      return data;\n    } catch (err) {\n      this._rejectLoaded(err);\n\n      return null;\n    }\n  }\n\n  erroring(err) {\n    return html``;\n  }\n\n  loading() {\n    return html``;\n  }\n\n  asyncRender() {\n    return Promise.reject('Must implement asyncRender() in child components');\n  }\n\n  render() {\n    const loaded = this.loaded();\n\n    if (loaded) {\n      return loaded();\n    }\n\n    const errored = this.errored();\n\n    if (errored) {\n      return errored;\n    }\n\n    return this.loading();\n  }\n\n}"],"names":[],"mappings":"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"}